<template>
    <ui-header nickname={nickname}></ui-header>

    <div class="body">
        <template if:true={session}>
            <!-- Unauthenticated -->
            <template if:false={isAuthenticated}>
                <template if:true={isRegistrationPhase}>
                    <ui-registration-form
                        onregistered={handleRegistered}
                    ></ui-registration-form>
                </template>
                <template if:false={isRegistrationPhase}>
                    <h1>Sorry, registrations are closed.</h1>
                </template>
            </template>

            <!-- Authenticated -->
            <template if:true={isAuthenticated}>
                <!-- Registration -->
                <template if:true={isRegistrationPhase}>
                    <h1>Waiting for host to start game...</h1>
                    <ui-spinner></ui-spinner>
                </template>

                <!-- Pre-question -->
                <template if:true={isPreQuestionPhase}>
                    <h1>Wait for question...</h1>
                    <ui-spinner></ui-spinner>
                </template>

                <!-- Question -->
                <template if:true={isQuestionPhase}>
                    <!-- Not yet answered -->
                    <template if:false={lastAnswer}>
                        <ui-question onanswer={handleAnswer}></ui-question>
                    </template>

                    <!-- Answered -->
                    <template if:true={lastAnswer}>
                        <h1>
                            You answered
                            <span data-answer={lastAnswer}>{lastAnswer}</span>
                        </h1>
                        <h1>Collecting answers from other players...</h1>
                        <ui-spinner></ui-spinner>
                    </template>
                </template>

                <!-- Question Results -->
                <template if:true={isQuestionResultsPhase}>
                    <template if:true={lastAnswer}>
                        <h1>
                            You answered
                            <span data-answer={lastAnswer}>{lastAnswer}</span>
                        </h1>
                    </template>
                    <template if:false={lastAnswer}>
                        <h1>
                            You didn't answer in time.
                        </h1>
                    </template>
                    <template if:false={isCorrectAnswer}>
                        <h1>
                            The correct answer was
                            <span data-answer={session.correctAnswer}
                                >{session.correctAnswer}</span
                            >
                        </h1>
                    </template>
                    <template if:true={isCorrectAnswer}>
                        <h1>Well done, that's correct!</h1>
                    </template>
                </template>

                <!-- Game Results -->
                <template if:true={isGameResultsPhase}>
                    <h1>Game over. Collecting results...</h1>
                    <ui-spinner></ui-spinner>
                </template>
            </template>
        </template>

        <!-- Errors -->
        <template if:true={errorMessage}>
            <h1 class="error">{errorMessage}</h1>
        </template>
    </div>
    <!-- End body -->

    <!-- Footer with score and rank -->
    <template if:true={showFooter}>
        <ui-footer leaderboard={playerLeaderboard}></ui-footer>
    </template>
</template>
